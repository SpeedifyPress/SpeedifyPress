(function(){var e=Object.defineProperty,t=(t,s,r)=>((t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r)(t,"symbol"!=typeof s?s+"":s,r);const s=class _JsDelayer{static patchedAddEventListener(e,t,s){if(!(_JsDelayer.capturing&&_JsDelayer.captureEvents.includes(e)&&window.speed_js_vars&&"true"===window.speed_js_vars.trigger_native_events))return this===window?_JsDelayer.nativeWinAdd.call(window,e,t,s):this===document?_JsDelayer.nativeDocAdd.call(document,e,t,s):_JsDelayer.nativeAdd.call(this,e,t,s);_JsDelayer.captured[e].push({target:this,listener:t,options:s})}static ensurePatchedAddListener(){_JsDelayer._addListenerPatched||(_JsDelayer._addListenerPatched=!0,EventTarget.prototype.addEventListener=_JsDelayer.patchedAddEventListener,window.addEventListener=_JsDelayer.patchedAddEventListener,document.addEventListener=_JsDelayer.patchedAddEventListener)}constructor(e="",t="",s=3,r=!1,i=!1){this.loadFirst=new Set(this.parseList(e)),this.loadLast=new Set(this.parseList(t)),this.timeout=1e3*s,this.debug=i,this.callback=r,this.callback_run=!1,this.hasTriggeredEvents=!1,this._loading=!1,this.savedClicks=new Set,this.savedMouseovers=new Set,this.interactionEvents=["click","mouseover","keydown","touchstart","touchmove","wheel"],this.init()}parseList(e){const t=e.split("\n").filter((e=>""!==e.trim()));return this.debug&&console.log("Parsed list:",t),t}init(){this.debug&&(console.log("JsDelayer initialized."),console.log("Load first scripts:",Array.from(this.loadFirst)),console.log("Load last scripts:",Array.from(this.loadLast)),console.log("Timeout set to:",this.timeout/1e3,"seconds")),this.bound_start=this.startLoading.bind(this),this.boundTrackUserInteractions=this.trackUserInteractions.bind(this),this.interactionEvents.forEach((e=>{window.addEventListener(e,this.bound_start,{passive:!0})})),window.speed_js_vars&&"true"===window.speed_js_vars.trigger_replays&&(this.debug&&console.log("Enabling replay tracking..."),window.addEventListener("click",this.boundTrackUserInteractions,{passive:!0}),window.addEventListener("mouseover",this.boundTrackUserInteractions,{passive:!0})),setTimeout(this.bound_start,this.timeout)}ensureTemplatesRestored(){if(!!document.querySelector(".unused-invisible > template")){this.debug&&console.log("Ensuring templates are restored before loading scripts...");try{if("function"==typeof window.restoreTemplateContentAndImages)return void window.restoreTemplateContentAndImages();document.querySelectorAll(".unused-invisible").forEach((e=>{const t=e.children[0];if(t&&"TEMPLATE"===t.tagName){e.style.contentVisibility="",e.style.containIntrinsicSize="";const s=t.content.cloneNode(!0);e.replaceChild(s,t)}}))}catch(e){this.debug&&console.error("Error while restoring templates before JS load:",e)}}}trackUserInteractions(e){void 0!==e&&window.speed_js_vars&&"true"===window.speed_js_vars.trigger_replays&&(this.debug&&console.log("Tracking user interaction:",e),"mouseover"==e.type&&this.savedMouseovers.add(e),"click"==e.type&&this.savedClicks.add(e))}startLoading(e){if(this._loading)return;if(this.debug&&console.log("Starting script loading process...",e),void 0!==e&&"mouseover"==e.type&&0==matchMedia("(hover: hover)").matches)return;"complete"===document.readyState||"interactive"===document.readyState?(this.ensureTemplatesRestored(),this._loading=!0,this.interactionEvents.forEach((e=>{window.removeEventListener(e,this.bound_start,{passive:!0})})),this.preloadScripts(),this.loadScripts()):this._pendingDomReady||(this._pendingDomReady=!0,this.debug&&console.log("DOM not ready yet; waiting for DOMContentLoaded before loading scripts."),document.addEventListener("DOMContentLoaded",this.bound_start,{once:!0}))}preloadScripts(){const e=this.getScriptOrder();0!=e.length&&e.forEach((e=>{if("LINK"===e.tagName){const t=e.getAttribute("data-href");if(!t)return;this.debug&&console.log("Restoring modulepreload:",t),e.setAttribute("href",t),e.removeAttribute("data-href"),e.hasAttribute("data-rel")&&(e.setAttribute("rel",e.getAttribute("data-rel")),e.removeAttribute("data-rel"))}if("SCRIPT"===e.tagName){const t="module"===(e.getAttribute("type")||"").toLowerCase(),s=e.getAttribute("data-src");if(!s||"null"===s||"undefined"===s)return;if(0===s.indexOf("data:"))return;const r=document.createElement("link");t?(r.rel="modulepreload",r.href=s,["crossorigin","integrity","referrerpolicy"].forEach((t=>{e.hasAttribute(t)&&r.setAttribute(t,e.getAttribute(t))})),this.debug&&console.log("Modulepreloading:",s)):(r.rel="preload",r.as="script",r.href=s,this.debug&&console.log("Preloading scriptz:",s)),document.head.appendChild(r)}}))}loadScripts(){const e=this.getScriptOrder().filter((e=>"SCRIPT"===e.tagName));0!=e.length&&this.loadScriptsSequentially(e)}getScriptOrder(){const e=[...document.querySelectorAll("script[data-src],link[data-rel='modulepreload']")],t=e.filter((e=>{const t=e.getAttribute("data-src")||e.getAttribute("data-href");return!!t&&Array.from(this.loadFirst).some((e=>t.includes(e)))})),s=e.filter((e=>{const t=e.getAttribute("data-src")||e.getAttribute("data-href");return!!t&&Array.from(this.loadLast).some((e=>t.includes(e)))})),r=e.filter((e=>{const t=e.getAttribute("data-src")||e.getAttribute("data-href");return!!t&&(!Array.from(this.loadFirst).some((e=>t.includes(e)))&&!Array.from(this.loadLast).some((e=>t.includes(e))))})),i=[...t,...r,...s];return this.debug&&(console.log("First scripts",t,this.loadFirst),console.log("Last scripts",s,this.loadLast),console.log("Scripts to load in order:",i.map((e=>e.getAttribute("data-src")||e.getAttribute("data-href"))))),i||0}loadScriptsSequentially(e){const t=()=>{window.speed_js_vars&&"true"===window.speed_js_vars.trigger_native_events&&(_JsDelayer.capturing=!1,_JsDelayer.captureEvents.forEach((e=>{_JsDelayer.captured[e].forEach((({target:t,listener:s})=>{try{const r=new Event(e,{bubbles:!0,cancelable:!0});s.call(t,r),this.debug&&console.log("Triggered",e,"listener for",s,"on",t)}catch(r){this.debug&&console.error("Error executing",e,"listener:",r)}})),_JsDelayer.captured[e]=[]})))},s=r=>{if(r>=e.length)return document.dispatchEvent(new Event("delayedJSLoaded")),this.debug&&console.log("All scripts loaded. Triggering events and replaying saved events..."),t(),void this.triggerEvents().then((()=>{if(setTimeout((()=>{window.speed_js_vars&&"true"===window.speed_js_vars.trigger_replays&&(this.debug&&console.log("Replaying saved events..."),window.removeEventListener("mouseover",this.boundTrackUserInteractions,{passive:!0}),window.removeEventListener("click",this.boundTrackUserInteractions,{passive:!0}),this.replaySavedEvents())}),100),this.callback&&!1===this.callback_run){const e=new Function(this.callback);"function"==typeof e&&(e(),this.callback_run=!0)}var e=this.getScriptOrder().length;this.debug&&console.log("Rerunning script loader...",e),e>0&&this.bound_start()}));const i=e[r];if(!i||"SCRIPT"!==i.tagName)return void s(r+1);const n=i.getAttribute("data-src");if(!n||"null"===n||"undefined"===n)return this.debug&&console.warn("Skipping script with invalid data-src:",i,n),void s(r+1);i.onload=()=>{_JsDelayer.capturing=!1,s(r+1)},i.onerror=()=>{_JsDelayer.capturing=!1,s(r+1)},_JsDelayer.capturing=!0,i.src=n,i.removeAttribute("data-src")};s(0)}triggerEvents(){return new Promise((e=>{if(this.hasTriggeredEvents)return this.debug&&console.log("triggerEvents already executed. Skipping..."),void e();if(this.hasTriggeredEvents=!0,window.jQuery&&"function"==typeof jQuery(document).get&&window.speed_js_vars&&"true"===window.speed_js_vars.trigger_jquery_events){const e=e=>{const t=jQuery._data(e,"events");["ready","load"].forEach((s=>{t&&t[s]&&t[s].forEach((({handler:t})=>{this.debug&&console.log("Triggering jQuery handler:",s,t),t(e)}))}))};e(document),e(window)}e()}))}replaySavedEvents(){this.debug&&(console.log("Replaying clicks",this.savedClicks),console.log("Replaying mouseovers",this.savedMouseovers));const e=(e,t)=>{e.forEach((s=>{e.delete(s);const r=s.target;if(this.debug&&console.log("Replaying "+t+" event for target:",r),r){const e=new MouseEvent(t,{view:s.view,bubbles:!0,cancelable:!0});r.dispatchEvent(e)}})),e.clear()};e(this.savedClicks,"click"),e(this.savedMouseovers,"mouseover")}};t(s,"_addListenerPatched",!1),t(s,"captureEvents",["readystatechange","DOMContentLoaded","load"]),t(s,"captured",{readystatechange:[],DOMContentLoaded:[],load:[]}),t(s,"capturing",!1),t(s,"nativeAdd",EventTarget.prototype.addEventListener),t(s,"nativeWinAdd",window.addEventListener),t(s,"nativeDocAdd",document.addEventListener);let r=s;r.ensurePatchedAddListener(),function(){const e=()=>{window.JsDelayer=new r(window.speed_js_vars.script_load_first||"",window.speed_js_vars.script_load_last||"",window.speed_js_vars.delay_seconds||6,window.speed_js_vars.delay_callback||!1,!1)};document.querySelectorAll(".spress_do_delay_js").length>0?(window.speed_js_vars.delay_seconds=.1,document.addEventListener("loggedInExceptionsDone",e,{once:!0})):(!0===document.prerendering&&(window.speed_js_vars.delay_seconds=0),e())}();})();